<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wxblog.core.dao.CategoryMapper">

    <resultMap id="categoryMap" type="Category">
        <id column="id" property="id"></id>
        <result column="name" property="name"></result>
        <result column="user_id" property="userId"></result>
        <result column="sort" property="sort"></result>
        <result column="created_at" property="createdAt"></result>
        <result column="total" property="topicToal"></result>
    </resultMap>
    
    <select id="selectByUserId" parameterType="long" resultMap="categoryMap">
        SELECT c.*,count(t.id)  as 'total' FROM blog_user_category c
        LEFT JOIN blog_topic t ON c.id=t.category_id
		GROUP BY c.id
        HAVING c.user_id=1
        ORDER BY c.sort ASC
    </select>
    
    <select id="maxSort" resultType="integer">
        SELECT max(sort) FROM blog_user_category
    </select>
</mapper>